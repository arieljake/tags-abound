
var validCreateUserFields = [
	"username",
	"password",
	"emailAddress",
	"firstName",
	"lastName",
	"location",
	"sex",
	"tags"
];

var validUpdateUserFields = [
	"emailAddress",
	"firstName",
	"lastName",
	"location",
	"sex",
	"tags"
];

var validUpdateUserPasswordFields = [
	"curPassword",
	"newPassword",
	"newPassword2",
];

module.exports.prepareForCreate = function (values)
{
	var newValues = {};

	for (var i = 0; i < validCreateUserFields.length; i++)
	{
		var fieldName = validCreateUserFields[i];

		if (values.hasOwnProperty(fieldName))
		{
			newValues[fieldName] = values[fieldName];
		}
	}

	return newValues;
};

module.exports.prepareForUpdate = function (updateValues,savedUser)
{
	for (var i = 0; i < validUpdateUserFields.length; i++)
	{
		var fieldName = validUpdateUserFields[i];

		if (updateValues.hasOwnProperty(fieldName))
		{
			savedUser[fieldName] = updateValues[fieldName];
		}
	}

	delete savedUser._id;

	return savedUser;
};

module.exports.prepareForUpdatePassword = function (updateValues,savedUser)
{
	if (updateValues.curPassword != savedUser.password)
		return null;

	if (updateValues.newPassword != updateValues.newPassword2)
		return null;

	if (!isValidPassword(updateValues.newPassword))
		return null;

	savedUser.password = updateValues.newPassword;

	delete savedUser._id;

	return savedUser;
};

var isValidPassword = function (password)
{
	return password.length >= 4;
};