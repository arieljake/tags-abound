
var fs = require('fs');

var ListlyEmailService = module.exports.ListlyEmailService = function (emailProvider,emailDir)
{
	var self = this;

	this.emailProvider = emailProvider;
	this.emailDir = emailDir;
};

ListlyEmailService.prototype.sendMessage = function (to,subject,text)
{
	this.emailProvider.sendMessage({
		from: "ariel@deskmasters.com",
		replyTo: ["ariel@deskmasters.com"],
		to: [to],
		subject: subject,
		text: text,
		html: text
	});
};

ListlyEmailService.prototype.sendRegistrationEmail = function (user)
{
	var self = this;

	fs.readFile(this.emailDir + "/registrationEmail.txt","UTF-8",function (err,data)
	{
		if (err)
		{

		}
		else
		{
			var message = data.toString().replace("#username#",user.username);
			message = message.replace("#userUrl#","http://localhost:3000/views/profile");

			self.sendMessage(
				"arieljake@yahoo.com",
				"Welcome to Listly!",
				message
			);
		}
	});
};